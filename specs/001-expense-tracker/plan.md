# Implementation Plan: Personal Expense Tracker

**Branch**: `001-expense-tracker` | **Date**: 2025-11-19 | **Spec**: [spec.md](./spec.md)
**Input**: Feature specification from `/specs/001-expense-tracker/spec.md`

**Note**: This document is generated by the `/speckit.plan` command.

## Summary

Build a single-page React application for personal expense tracking with CRUD operations, dashboard visualization, category-based summaries, dark/light theme support, and English/Chinese internationalization. All data persists locally via localStorage (no authentication, no cloud sync). Key features include: add/edit/delete expenses, view 10 most recent expenses, category totals sorted by spending, and CSV export functionality.

## Technical Context

**Language/Version**: TypeScript 5+ (strict mode)  
**Primary Dependencies**: React 18+, shadcn/ui, Tailwind CSS, Vite, React Router 6+  
**Storage**: Browser localStorage exclusively (namespaced with `sdd_workshop_expense_tracker_`)  
**Testing**: Vitest + React Testing Library for unit/component tests; Playwright for E2E (if needed)  
**Target Platform**: Modern web browsers (Chrome 90+, Firefox 88+, Safari 14+, Edge 90+)  
**Project Type**: Web - Single Page Application (frontend only)  
**Performance Goals**: Dashboard load < 1s, CRUD operations < 100ms response, support 1,000 expense records without degradation  
**Constraints**: localStorage 5MB limit, WCAG 2.1 Level AA compliance, responsive 320px-1920px, offline-capable  
**Scale/Scope**: Single-user local application, ~10-15 React components, 6 user stories, localStorage-based state

## Constitution Check

*GATE: Must pass before Phase 0 research. Re-check after Phase 1 design.*

### I. Code Quality First ✅

- **Type Safety**: TypeScript strict mode enforced in `tsconfig.json`
- **Linting**: ESLint + Prettier configured for React/TypeScript
- **Code Review**: All implementation requires PR review against checklist
- **Clean Code**: Component functions < 50 lines; custom hooks for reusable logic
- **Documentation**: JSDoc for complex utility functions and custom hooks

**Status**: PASS - Plan aligns with quality standards

### II. Testing Standards (NON-NEGOTIABLE) ✅

- **Test-First Development**: Tests written before implementation per task order
- **Coverage Requirements**:
  - Unit tests for: localStorage utilities, expense validation, date/currency formatting
  - Component tests for: ExpenseForm, ExpenseList, CategorySummary, Dashboard
  - Integration tests for: complete CRUD flows, multi-tab sync, CSV export
- **Test Structure**:
  - Unit: `src/components/[Component]/__tests__/[Component].test.tsx`
  - Integration: `tests/integration/expense-operations.test.tsx`
  - Utilities: `src/utils/__tests__/[utility].test.ts`
- **Testing Philosophy**: Test user-visible behavior (form submission, data display), not implementation (state updates)

**Status**: PASS - Comprehensive test strategy defined

### III. User Experience Consistency ✅

- **Design System**: shadcn/ui components for all UI elements (Button, Card, Form, Dialog, Select, etc.)
- **Accessibility**:
  - Semantic HTML: `<main>`, `<form>`, `<button>`, `<table>`
  - ARIA labels for icon buttons, screen reader announcements for operations
  - Keyboard navigation: Tab order, Enter/Space for actions, Escape for dialogs
  - Color contrast: Verified for both light/dark themes
- **Responsive Design**: Mobile-first approach with Tailwind breakpoints (sm, md, lg, xl)
- **Loading States**: Skeleton loaders for dashboard, spinners for operations
- **Performance**: React.memo for expensive components, useMemo/useCallback for optimizations

**Status**: PASS - Meets all UX requirements

### IV. Single Storage Technology ✅

- **One Technology**: localStorage only (no sessionStorage, IndexedDB, cookies)
- **Namespace Keys**: All keys prefixed `sdd_workshop_expense_tracker_`
  - `sdd_workshop_expense_tracker_expenses`: Array of expense objects
  - `sdd_workshop_expense_tracker_preferences`: Theme and language settings
  - `sdd_workshop_expense_tracker_version`: Data format version (1.0.0)
- **Data Structure**: JSON strings with version identifier for migrations
- **Size Limits**: Monitor storage, warn at 80% capacity (4MB)
- **Error Handling**: Try-catch for QuotaExceededError, user notification with option to export/clear data
- **Security**: No sensitive data stored (no auth system per spec)

**Status**: PASS - Adheres to single storage principle

### V. Component-Driven Development ✅

- **Component Structure**:
  - Presentational: ExpenseCard, CategoryBadge, EmptyState, LoadingSpinner
  - Container: Dashboard (orchestrates), ExpenseForm (handles CRUD)
  - Layout: AppLayout (header, theme toggle, language selector)
- **Context API**: 
  - ThemeContext (light/dark mode)
  - LanguageContext (en/zh i18n)
  - ExpenseContext (CRUD operations, state management)
- **Single Responsibility**: Each component has focused purpose
- **Reusability**: Leverage shadcn Card, Button, Form, Dialog, Select components
- **Component Documentation**: TypeScript interfaces exported, JSDoc for props

**Status**: PASS - Component architecture aligns with principles

### Overall Assessment

**CONSTITUTION COMPLIANCE: ✅ PASS**

All 5 core principles satisfied. No complexity violations requiring justification. Proceed to Phase 0 (Research).

## Project Structure

### Documentation (this feature)

```text
specs/001-expense-tracker/
├── plan.md              # This file (/speckit.plan command output)
├── spec.md              # Feature specification
├── research.md          # Phase 0 output - Technology decisions and patterns
├── data-model.md        # Phase 1 output - Entity schemas and relationships
├── quickstart.md        # Phase 1 output - Developer onboarding guide
├── contracts/           # Phase 1 output - TypeScript interfaces
│   ├── expense.types.ts # Expense entity types
│   ├── storage.types.ts # localStorage interfaces
│   └── i18n.types.ts    # Translation types
├── checklists/
│   └── requirements.md  # Quality validation checklist
└── tasks.md             # Phase 2 output (/speckit.tasks command - NOT created by /speckit.plan)
```

### Source Code (repository root)

```text
# React Single Page Application
src/
├── components/
│   ├── Dashboard/
│   │   ├── Dashboard.tsx
│   │   └── __tests__/Dashboard.test.tsx
│   ├── ExpenseForm/
│   │   ├── ExpenseForm.tsx
│   │   └── __tests__/ExpenseForm.test.tsx
│   ├── ExpenseList/
│   │   ├── ExpenseList.tsx
│   │   ├── ExpenseCard.tsx
│   │   └── __tests__/ExpenseList.test.tsx
│   ├── CategorySummary/
│   │   ├── CategorySummary.tsx
│   │   ├── CategoryBadge.tsx
│   │   └── __tests__/CategorySummary.test.tsx
│   ├── Layout/
│   │   ├── AppLayout.tsx
│   │   ├── Header.tsx
│   │   └── ThemeToggle.tsx
│   └── ui/              # shadcn components (auto-generated)
│       ├── button.tsx
│       ├── card.tsx
│       ├── form.tsx
│       └── dialog.tsx
├── context/
│   ├── ThemeContext.tsx
│   ├── LanguageContext.tsx
│   └── ExpenseContext.tsx
├── utils/
│   ├── localStorage.ts
│   ├── validation.ts
│   ├── formatting.ts
│   ├── csvExport.ts
│   └── __tests__/
│       ├── localStorage.test.ts
│       ├── validation.test.ts
│       └── formatting.test.ts
├── hooks/
│   ├── useLocalStorage.ts
│   ├── useExpenses.ts
│   └── useStorageSync.ts
├── i18n/
│   ├── en.json
│   ├── zh.json
│   └── translations.ts
├── types/
│   ├── expense.ts
│   ├── preferences.ts
│   └── index.ts
├── App.tsx
├── main.tsx
└── index.css

tests/
├── integration/
│   ├── expense-crud.test.tsx
│   ├── multi-tab-sync.test.tsx
│   └── csv-export.test.tsx
└── e2e/                 # Optional Playwright tests
    └── user-journeys.spec.ts

# Configuration files
├── package.json
├── tsconfig.json
├── vite.config.ts
├── tailwind.config.ts
└── eslint.config.js
```

**Structure Decision**: Selected **Web Single Page Application** structure. This is a frontend-only React application with no backend (data stored in localStorage). All components organized by feature area (Dashboard, ExpenseForm, etc.) with co-located tests following React Testing Library conventions. shadcn components live in `src/components/ui/` as per their CLI installation pattern.

## Complexity Tracking

> **No violations detected** - Constitution Check passed all gates without exceptions.

N/A - All principles satisfied without need for complexity justification.
